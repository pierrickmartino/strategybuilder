# Story 1.1 NFR Assessment (2025-09-27)

## Overview
- Assessed NFRs: Security, Performance, Reliability, Maintainability, Usability, Compatibility, Portability, Functional Suitability
- Quality score: 80
- Overall posture: **CONCERNS** (performance observability + maintainability test gaps)

## Attribute Notes
- **Security – PASS:** Protected routes enforce authenticated access and consent across middleware and API layers, and OAuth callbacks persist compliance metadata before redirecting users (`apps/web/src/middleware.ts:5`, `apps/api/app/auth/dependencies.py:69`, `apps/web/src/app/api/auth/callback/route.ts:31`).
- **Performance – CONCERNS:** React Query hydrates the workspace only once and backend provisioning uses async SQLAlchemy, but we still lack telemetry or automated validation for the documented P95 <150 ms target (`apps/web/src/hooks/use-workspace-bootstrap.ts:47`, `apps/api/app/services/workspace_service.py:74`, `docs/architecture/security-and-performance.md:26`).
- **Reliability – PASS:** Workspace bootstrap gracefully surfaces API failures in the UI and backend tests cover consent rejection and idempotent provisioning (`apps/web/src/app/(dashboard)/[locale]/strategies/strategies-workspace.tsx:186`, `apps/api/tests/test_workspace_bootstrap.py:99`).
- **Maintainability – CONCERNS:** Core flows have unit coverage (middleware, store, backend) but the Playwright scenario remains a fixme and there is no automated test for the consented OAuth path (`apps/web/src/middleware.test.ts:5`, `apps/web/src/stores/workspace-store.test.ts:49`, `tests/e2e/onboarding.spec.ts:4`).
- **Usability – PASS:** Auth flow clearly blocks submission until consent is captured and returns localized error/status messages, while the workspace screen presents onboarding callouts and error feedback (`apps/web/src/app/(auth)/[locale]/login/auth-form.tsx:55`, `apps/web/src/app/(dashboard)/[locale]/strategies/strategies-workspace.tsx:123`).
- **Compatibility – PASS:** Locale-aware routing resolves unknown locales safely and the bootstrap flow depends only on standard browser APIs plus Supabase helpers, matching documented tech stack expectations (`apps/web/src/app/api/auth/callback/route.ts:6`, `apps/web/src/hooks/use-workspace-bootstrap.ts:10`, `docs/architecture/tech-stack.md:8`).
- **Portability – PASS:** Both web and API layers derive configuration from environment variables with safe defaults, enabling local or hosted deployment without code edits (`apps/web/src/lib/supabase/server.ts:3`, `apps/api/app/config.py:24`).
- **Functional Suitability – PASS:** Auth consent, workspace seeding, and audit capture satisfy acceptance criteria and persisted compliance events on bootstrap (`apps/api/app/api/routers/workspaces.py:18`, `apps/api/app/services/audit_service.py:17`, `docs/stories/1.1.platform-skeleton-authentication.md:12`).

## Recommendations
1. Instrument latency for `/api/v1/workspaces/bootstrap` (e.g., Datadog span or structured timing log) and add an assertion in CI to catch regressions against the 150 ms target.
2. Promote the Playwright onboarding scenario from `test.fixme` to an executable flow (seed Supabase test user, assert audit event) to protect the consent + bootstrap happy path.
3. Add a frontend integration test that exercises the OAuth consent checkbox and callback metadata update to lock in the compliance guard.
