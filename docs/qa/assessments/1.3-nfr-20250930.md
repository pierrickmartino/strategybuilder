# NFR Assessment – Story 1.3 (2025-09-30)

## Summary
- Quality Score: 70
- Assessed Attributes: security, performance, reliability, maintainability, usability, compatibility, portability, functional_suitability
- Status Mix: PASS (4), CONCERNS (4)

## Findings by Attribute

### Security – PASS
- Evidence: All onboarding data fetches require Supabase bearer tokens and enforce compliance consent before serving responses, aligning with project security controls for authenticated APIs ([apps/web/src/services/templates.ts](../../apps/web/src/services/templates.ts#L1) + [apps/api/app/api/routers/templates.py](../../apps/api/app/api/routers/templates.py#L9)).
- Additional: Analytics bridge rehydrates tokens on demand and requeues events when flush fails, preventing unauthenticated leakage ([apps/web/src/components/onboarding/OnboardingAnalyticsBridge.tsx](../../apps/web/src/components/onboarding/OnboardingAnalyticsBridge.tsx#L10)).
- Risk: None observed beyond standard auth/token expiry handling.

### Performance – PASS
- Evidence: React Query caching (5–10 minute staleness windows) prevents redundant onboarding fetches, supporting the <150 ms API target from architecture guidance ([apps/web/src/hooks/use-templates.ts](../../apps/web/src/hooks/use-templates.ts#L1)).
- Validation: Playwright onboarding flow keeps bootstrap under the defined latency budget, indicating endpoints meet current targets ([tests/e2e/onboarding.spec.ts](../../tests/e2e/onboarding.spec.ts#L87)).
- Risk: Future template volume growth may require pagination but does not breach current thresholds.

### Reliability – PASS
- Evidence: Onboarding progress store drains and requeues analytics payloads with unit coverage for all resilience branches ([apps/web/tests/unit/onboardingProgress.test.ts](../../apps/web/tests/unit/onboardingProgress.test.ts#L11)).
- Evidence: Backend tests confirm compliance and analytics events persist atomically for each onboarding interaction ([apps/api/tests/test_onboarding_features.py](../../apps/api/tests/test_onboarding_features.py#L100)).
- Risk: None significant; existing monitoring stack tracks onboarding completion metrics.

### Maintainability – CONCERNS
- Strengths: Component boundaries keep onboarding UI in dedicated folders with shared state store.
- Gaps: No direct component tests for `TemplateLibrary` or `EducationHub`, leaving tooltip/disclaimer rendering and compliance tag display unverified and raising coverage debt relative to testing strategy expectations ([docs/architecture/testing-strategy.md](../..//docs/architecture/testing-strategy.md#L1)).
- Action: Add RTL tests that mount each component and assert copy/tooltips plus mark-step side effects.

### Usability – CONCERNS
- Evidence: Checklist integration test ensures accessible labels for progress controls ([apps/web/tests/integration/OnboardingChecklist.test.tsx](../../apps/web/tests/integration/OnboardingChecklist.test.tsx#L22)).
- Gaps: Lack of automated verification that template tooltips, disclaimers, and education resource links render or remain accessible leaves onboarding guidance vulnerable to regressions.
- Action: Extend integration coverage to check tooltip aria attributes, compliance badges, and responsive layouts.

### Compatibility – PASS
- Evidence: Template library honours locale-aware routing and gracefully handles empty/error states with standard Next.js primitives ([apps/web/src/components/onboarding/TemplateLibrary.tsx](../../apps/web/src/components/onboarding/TemplateLibrary.tsx#L75)).
- Evidence: Education hub links rely on basic anchors with external targets, compatible across browsers ([apps/web/src/components/onboarding/EducationHub.tsx](../../apps/web/src/components/onboarding/EducationHub.tsx#L27)).
- Risk: None noted; no platform-specific APIs introduced.

### Portability – PASS
- Evidence: Services use environment-derived API base URLs, supporting deployment across staging/prod without code edits ([apps/web/src/services/analytics.ts](../../apps/web/src/services/analytics.ts#L1)).
- Evidence: Backend routers depend solely on shared service layers, keeping infrastructure-independent business logic ([apps/api/app/services/template_service.py](../../apps/api/app/services/template_service.py#L1)).

### Functional Suitability – CONCERNS
- Evidence: Analytics, compliance logging, and checklist progression validated end-to-end ([tests/e2e/onboarding.spec.ts](../../tests/e2e/onboarding.spec.ts#L109)).
- Gaps: Automated coverage does not confirm UI rendering of template tooltips/disclaimers or education content, leaving parts of AC2 and AC3 reliant on manual verification.
- Action: Add UI-level assertions for block annotations, disclaimers, and education hub media to close acceptance gaps.

## Recommendations
1. Add React Testing Library suites for `TemplateLibrary` and `EducationHub` to cover tooltips, disclaimers, compliance badges, and mark-step triggers.
2. Extend Playwright onboarding journey to interact with template selection and education panels, asserting telemetry side effects and resource link visibility.
3. Monitor template payload growth to determine whether pagination or lazy loading is needed to stay within latency targets.

---
Quality Score Formula: 100 - 10 × (#CONCERNS) = 70
